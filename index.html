<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mon Rucher Pro - Interface Ã‰purÃ©e</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#f1c40f">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/517/517563.png">
</head>
<body>

    <header>
        <h1>ğŸ <span class="titre-miel" style="color: #8B6508; font-weight: 900; text-transform: uppercase;">Mon Rucher</span> ğŸ</h1>
        <div id="compteur-cheptel" style="text-align: center; font-size: 0.9rem; color: #8B6508; font-weight: bold; margin-bottom: 10px;">
    Ruches : 0 | Ruchettes : 0
</div>
        <div class="btn-container">
            <button class="btn-add" onclick="ajouterNouvelleRuche()">â• Ruche</button>
            <button class="btn-add" style="background-color: #3498db; color: white;" onclick="ouvrirPromptRang()">â• Rang</button>
            <button class="btn-add" style="background-color: #27ae60; color: white;" onclick="exporterRucher()">ğŸ“¤ Sauver</button>
            <button class="btn-add" style="background-color: #e67e22; color: white;" onclick="document.getElementById('import-file').click()">ğŸ“¥ Charger</button>
            <input type="file" id="import-file" style="display:none" onchange="importerRucher(event)">
        </div>
    </header>

    <div id="nav-controls">
        <button onclick="zoom(1.2)">â•</button>
        <button onclick="zoom(0.8)">â–</button>
        <button onclick="recentrer()">ğŸ¯</button>
    </div>

    <div id="grille-libre"></div>

    <div id="modal-visite" class="modal">
        <div class="modal-content">
            <h2 id="modal-titre" style="margin-top:0; color:var(--primary);">DÃ©tails Ruche</h2>
            
            <div id="menu-choix">
                <button class="btn-save" onclick="afficherFormulaire()">ğŸ“ Nouvelle Visite</button>
                <button class="btn-save" style="background:#2980b9;" onclick="afficherHistoriqueComplet()">ğŸ“œ Historique</button>
                <button class="btn-save" style="background:#8e44ad;" onclick="afficherElevage()">ğŸ‘‘ Ã‰levage Reine</button>
                <hr style="border:0; border-top:1px solid #444; margin:15px 0;">
                <button class="btn-save" style="background:#7f8c8d;" onclick="modifierInfosRuche()">âš™ï¸ Renommer</button>
                <button class="btn-cancel" style="background:#c0392b;" onclick="supprimerRucheDefinitif()">ğŸ—‘ï¸ Supprimer</button>
                <button class="btn-cancel" onclick="fermerModal()">Fermer</button>
            </div>

            <div id="ecran-formulaire" style="display:none;">
                <label>RÃ©serves (Cadres) :</label>
                <input type="number" id="cadre-reserve" placeholder="0">
                <label>Couvain (Cadres) :</label>
                <input type="number" id="cadre-couvain" placeholder="0">
                <label>Note Globale :</label>
                <select id="note-ruche">
                    <option value="S">S (Exceptionnelle)</option>
                    <option value="A" selected>A (TrÃ¨s bien)</option>
                    <option value="B">B (Moyenne)</option>
                    <option value="C">C (Ã€ surveiller)</option>
                </select>
                <label>Observations :</label>
                <textarea id="notes-visite" rows="3" placeholder="Notes particuliÃ¨res..."></textarea>
                <button class="btn-save" onclick="sauvegarderVisite()">Enregistrer</button>
                <button class="btn-cancel" onclick="revenirAuMenu()">Annuler</button>
            </div>

            <div id="ecran-historique" style="display:none;">
                <h3>Historique des visites</h3>
                <div id="liste-historique-complete" style="max-height:300px; overflow-y:auto; background:#111; border-radius:8px;"></div>
                <button class="btn-cancel" style="margin-top:10px;" onclick="revenirAuMenu()">Retour</button>
            </div>

            <div id="ecran-elevage" style="display:none;">
                <h3 style="color:#8e44ad;">Calendrier d'Ã‰levage</h3>
                <div id="info-elevage-vide">
                    <p style="text-align:center; padding:10px; color:#bbb;">Aucun cycle d'Ã©levage en cours sur cette colonie.</p>
                    <button class="btn-save" style="background:#8e44ad;" onclick="demarrerCycle()">DÃ©marrer un cycle (J0)</button>
                </div>
                <div id="calendrier-actif" style="display:none;">
                    <div id="liste-dates-elevage" style="background:#111; border-radius:8px; margin-bottom:15px;"></div>
                    <button class="btn-cancel" style="background:#c0392b; margin-bottom:10px;" onclick="stopperCycle()">ArrÃªter le cycle</button>
                </div>
                <button class="btn-cancel" onclick="revenirAuMenu()">Retour</button>
            </div>
        </div>
    </div>

    <div id="modal-edit-rang" class="modal">
        <div class="modal-content">
            <h3>ParamÃ¨tres du Rang</h3>
            <label>Nom :</label>
            <input type="text" id="edit-nom-rang">
            <label>Couleur :</label>
            <div style="display:flex; gap:10px; align-items:center;">
                <input type="color" id="edit-couleur-rang">
            </div>
            <button onclick="validerEditRang()" class="btn-save">Appliquer</button>
            <button onclick="supprimerRangActuel()" class="btn-cancel" style="background:#e74c3c;">ğŸ—‘ï¸ Supprimer le Rang</button>
            <button onclick="fermerModalEditRang()" class="btn-cancel">Fermer</button>
        </div>
    </div>

    <div id="modal-rang" class="modal">
        <div class="modal-content">
            <h3>Nouveau Rang</h3>
            <input type="text" id="nom-rang-input" placeholder="Nom (ex: Ligne Nord)">
            <select id="orientation-rang-input">
                <option value="column">Vertical (Colonne)</option>
                <option value="row">Horizontal (Ligne)</option>
            </select>
            <button onclick="creerRang()" class="btn-save">CrÃ©er</button>
            <button onclick="fermerModalRang()" class="btn-cancel">Annuler</button>
        </div>
    </div>

    <div id="modal-type" class="modal">
        <div class="modal-content">
            <h3>Ajouter Ã  quel rang ?</h3>
            <select id="select-rang-destination" style="margin-bottom: 15px; padding: 10px;"></select>
            
            <h3>Type de colonie ?</h3>
            <button onclick="validerType('RUCHE')" class="btn-save">RUCHE</button>
            <button onclick="validerType('RUCHETTE')" class="btn-save" style="background:#2980b9;">RUCHETTE</button>
            <button onclick="fermerModalType()" class="btn-cancel">Annuler</button>
        </div>
    </div>

    <script src="sortable.js"></script>
    <script src="app.js"></script>
</body>
</html>